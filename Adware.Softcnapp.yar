rule Adware_Softcnapp {
   meta:
      description = "Adware.Softcnapp"
      author = "LightDefender"
      date = "2021-08-02"
      hash1 = "01567b9763db0e7e38d681a5c346985e45a7e075d2a7edd84b431c461565f821"
      hash2 = "7c12c51bb4253b957647a4a71c3ab99e25b220a4813708724efd89960a581fd8"
      hash3 = "ee149fac6ca98c043f204fed8d946b32f0b5d736660bad134f171b2ed8a83520"
      hash4 = "7aba2c0649ac5e206d98f0ae510a42de69ef5361111d3bee532be37e820a7222"
      hash5 = "9e48d2ce8ec2c8832e84c3f54ec131c8d8edd83e4947d6e2d829f05b00ef9171"
   strings:
      $s1 = "TaskStart" fullword ascii
      $s2 = "TaskFree" fullword ascii
      $s3 = "OneTimes" fullword wide
      $s4 = "RunBus" fullword wide
      $s5 = "RunPath" fullword wide
      $s6 = "MinVer" fullword wide
      $s7 = "MaxVer" fullword wide
   condition:
      uint16(0) == 0x5a4d and all of them
}

rule Adware_Softcnapp_2 {
   meta:
      description = "Adware.Softcnapp"
      author = "LightDefender"
      date = "2021-08-09"
      hash1 = "ff8a5205f0e431c3f3c426013a881fd659b60033fae7cfa0b37c3e02cd0cc0cb"
      hash2 = "869d7b30a917c8860369d303ac283cba013190e0cfa0525140d1faab5f44c4ec"
      hash3 = "60dcbd3e0cba37efae5a69e9349bb683c5cb67fa750aeb3ad30a30c48328489a"
      hash4 = "fe8de42e0f425b092b3f3496311c156fcb19fc7be6cc5e2b5d5ea723ec9f469b"
      hash5 = "9e4a80537a7fc4095f635e560ca42c5086bcd8121bdac75d90b97edc7bedf8cb"
      hash6 = "7cbb8cef32fc8f529656b5b4093a01beae49e5c83023a91cafca802da3cd97b4"
      hash7 = "0c6714f42ec5e2ad576b68b522d43ff43d7476f7ddc1010d3eb67e5291f800a7"
      hash8 = "2534e7646cf546886dc4dd635c54aa35381aaac6105bea95715eea1e26301c5b"
      hash9 = "b7892addff3e30f20bb126ffa8bb0dd814bae3cc6a01d97c153faa7b161d865a"
      hash10 = "c20121b6dd2b492e4a7d421ce0f63298e6a3b2f6349bc23cf00921eecde1149a"
      hash11 = "6cf8acfa205ef1e066dce25845d59935f2eadb4a30c3d8ca117cfed276809e3f"
      hash12 = "9297aea729c4aed591deecbbcaaa30a09cdaae4e51c158a18a0fce2aeb1b9f68"
      hash13 = "b361e3b68dc115545e6e6e94e24dbd9e8da4d5739b98f0d2e8b836cb321e6f65"
      hash14 = "7c12c51bb4253b957647a4a71c3ab99e25b220a4813708724efd89960a581fd8"
      hash15 = "f96b390da1accefd9ff73d297a6a016670be7b59ed096cbddc6eaa40f4407c22"
      hash16 = "02cf434c49e5640ab9a846fe9a8fee379b750cd2602dc316221d0db5890aa6f8"
      hash17 = "ef119a8f62e8ed95d096084355449d84b346138175e11346379e59048b9e3f6e"
      hash18 = "46f7b91ca5a3094471f93e7117be97a6d182c5bf8af5002b429debdffe3487b7"
      hash19 = "ede8c0b10aa7e76f272e95205bb7955408869004f8fdad9a3a99aaf528e60c0b"
      hash20 = "aa57c872c6d45ce3bfcac19c6128294d8e9a7380d219d36620843147d4140e4a"
      hash21 = "d6b3c5c48414bc149601cab7381270857f4c0cc795bdf0e4de776d4c462d819b"
      hash22 = "a73d92c0f2e645b6bde4896bd26eeda93edfddaaeecff7eb5f886dc3f909cd7a"
      hash23 = "19716d90693c7631e0f5772b7873e22724b5a0b982d88ad4014e41b214f064a1"
      hash24 = "73978e1e05aa6fe6330edea3f30a2e75f9da500099ec8f8b4f712b95763f52d6"
      hash25 = "334bd9e3283d9c816f1a086e841c14262569f8a712e42d7db151643cc9323b70"
      hash26 = "bb2fef028b0ab2cd60909fd3d2c91efedd0a250bc0a714878d80a7329e4bba6f"
      hash27 = "606311a7983279bb2e06e7aab3259bfc07b181a632a4059ff992f725fc2343c8"
      hash28 = "bff8346e3aee724370459a2cfed06fdd5023de30d9d78e2ace3f612fd2a73676"
      hash29 = "373eea1c3d97a414179b01b322467d064beddd5114cb6935f3e3e1a194de97b8"
      hash30 = "8c89adde496b39f6609a588af6d38cb2d38b7df75bc3ea772bda693428534573"
      hash31 = "dda0593d800a2e2c5fbdc5641ed445fba1b65254197d43964d116b34a31949ae"
      hash32 = "da6a3b02372bc81412d1622576f5440d0e8c938e3d5a7774c57f3b14fbdfe782"
      hash33 = "6f49f153ca7065f1d97edcd84061f297591006af7d678bcb43640642ad32b8d5"
      hash34 = "a88b822ac6389e0c434930807d27800e53fd19fe6926b72099b632ac5b8a819e"
      hash35 = "95a05deb5c3ba87bc61453dd4fa41e7933f604e731b762aaf25c99229cf1e5ea"
      hash36 = "4b8690946f6b68bd06c5a9e07de63bef2767b6ab1797f0ae4f356622ca81ecbc"
      hash37 = "d63ff1a5945c9e48661295ba21537ee77dcb5caeca1b47f0a9ea44f998781620"
      hash38 = "0abe6926a160bb4310076a873dd5902b084cd98612f38f71f27c980f7d7a4f29"
      hash39 = "222fcf95c1b4eeef97d1c50cda99c5bc569acada22272b2d220198d50c46f3ff"
      hash40 = "263dca03c8cfb560b40972fed48252ce06ad907bf5a5ff9c29caadf8e39e6917"
      hash41 = "0cbbddfebeb0590903c9b6912cec39de25c4c5519a6109963edf248ca0bc2c14"
      hash42 = "1b900b74f163af8eb275c8dc94114aa383edba1f06a91f80ac53fceafb9cf655"
      hash43 = "c2efc4087ce7a758435cbb2abb5c9961546c1b0636301dddd2b1f9ffcda39145"
      hash44 = "03b3a12576d28bd21bbb50e9b495baea54c0144e12898b8b3bb5e3e4d4a78d95"
      hash45 = "f282188ecb8e17cce78b42914e4dcfcf1b43289a0917550ba13a727536350c59"
      hash46 = "5fd873fd03c6e839ff95943dc91008301c9765ca570e186232e62fbb498f62f9"
      hash47 = "8228a1ea48b48e1a104d3674ee0129d1827c076ecef1c240d3bfe54179756f18"
      hash48 = "25b2afcceb375ee102e48e602341e5a408adbd4a47c714984b8669647eb4af1b"
      hash49 = "1365373d267ac75e8017ede1d569f128a281a139a861aca9b2792507ff91d19a"
      hash50 = "ae0e9254885795d735a1b13bb2e99577dec52e7b6bf3bffc33befee84e1bbe64"
      hash51 = "893186440d9d6bb82a13d1a8bad23e18a7c30b85101461801dd82f96bd1819f6"
      hash52 = "2be5e63763f6950e2b0e4b7b440ec10bed29c883a09488ea8f6ff50fb2f9e7bb"
      hash53 = "2f00d93171b3fcae8147f08f3b82f348dd95f7b71a3fa94ab74db02f136b5c41"
      hash54 = "3d11f84c62b2688dec5b14fad20b9f313ea3f371c5ad79d313dd779e076e0bb3"
      hash55 = "02b19a9e831834b2ed7d1887c24e6ab99378716d5de5251968d8b347bd0709be"
      hash56 = "b97eaf9717f70e4baa578c75ca34ac1e0f3e46b7708d9cf3ca78ed950db231d7"
      hash57 = "f145ac9565371e0ab0279a04a61d9492e51107f7b76b51dc1f5b114344a0887c"
      hash58 = "c641a037fddd04689014c73a2f8840ed4304238b186ba3be2b2378dc847d6514"
      hash59 = "d0c28882405063f2a6e44bd8ff83eaa574660018bbfcaf6be380b302b713b1e4"
      hash60 = "4cc9603705240010036a71b581d388d1baa1f13fb9bb95acc609e1e27e9271ab"
      hash61 = "02a5f0ba394375635bcbcafd927e3e5774299f5f6286f154b104eff5320d7925"
      hash62 = "9e707195ca74f147e245c37372ddd9d021ac77b45cd1c92e3a8697264664a60e"
      hash63 = "5767c8b52b1ecd1f92158178fbbbd71fd95b9d1011a0b66814dff300e607c9d7"
      hash64 = "dd4b798e88248407fac5d848c391ee70a10ab798f97469f9aeb79381af2251bf"
      hash65 = "36b76ae538f0f8bc073fe97730a0388de1b88a66ac2d948b763f92e5dd350052"
      hash66 = "e2af104aefb191865e0d9544a436dfb7359a9a8991257409202126eac5ec1ebf"
      hash67 = "0aee082a456b58769d3ce03462229c0d92eda07162240fb5b189884b80e7b69d"
      hash68 = "1d52c6703029d0acc309cc5b0607a8c60671ff11376817bf07df75bf60c1a65e"
      hash69 = "49b3ac74d6d526f3dd0b72191a7d6e1bb759a2ac776799b298a05c9191a77637"
      hash70 = "7c70b592fd545863e040e7b3fc45f900d159a0f54b66e6b642c6b4550d44b894"
      hash71 = "8eccc4ab8fdfae1b6e81c509c6aad703d58ab59b61bee6552b50182ba75be45b"
      hash72 = "01bb6f2cfb5bab05ce53adc93bc145f8e7ff405807899b9905fd4769ec0c02ba"
      hash73 = "feeca1cccb8e5b74492fd18af4556366f408de26f1d26cb2a31e6b110fdcea1a"
      hash74 = "92d9e5a070ae5f6600b3bbe966bfd91059d56f0ec1d9236f8fcd33844e42d53a"
      hash75 = "4c073fe694372c544711b8995078053d9f65bd51a4fc44b6114d22ff70acf5a4"
      hash76 = "023c590428ce63b15773a15a9a8845f30d3dd8d204ebe9a9c757834325cc6790"
      hash77 = "3017d04d1976e87f2d779ff387dbaed18529d9502486ce00226598a65db7435e"
      hash78 = "d414eaeeed500dab105eb249bbc576de6874338d5141d89fcab61dd949f9883e"
      hash79 = "b49bbea57bc451cbc002c096073a54840926d97f7a58649984112b3a36909cea"
      hash80 = "fa1a11577885b19f2d4e81002e02e8cce180e32d8c465ff26c6b4b71dea0a7a7"
      hash81 = "1fade88081b11bee03e7693e13fe3fb4a53c3c00284d8362876e23ce700f2489"
      hash82 = "c450c8095a036bb6339d1cd1cbbc3c27f68bea158c8c1ea97d24109fa738d9c9"
      hash83 = "634ec1a44208820cea897c52dc40a1e4584fda42eea0141d7b2a3e1b872a4195"
      hash84 = "a3a7156701e85d8f15cf5bbf8290d051ebf3102efcf3efde18b56f18e75bc241"
   strings:
      $s1 = "documents and settings\\localservice" fullword wide
      $s2 = "\\LocalLow" fullword wide
      $s3 = "\\Local" fullword wide
      $s4 = "\\Roaming" fullword wide
      $s5 = "config\\systemprofile" fullword wide
   condition:
      uint16(0) == 0x5a4d and all of them
}
