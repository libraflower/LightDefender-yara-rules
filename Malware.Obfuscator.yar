rule Malware_Obfuscator_1 {
   meta:
      description = "Malware.Obfuscator"
      author = "LightDefender"
      date = "2021-07-01"
      hash1 = "9f2d892a4f124d1b693d8ceafc6ebe8741484109f68d82ec49ac2c9d781483a7"
      hash2 = "164d8d2e1460f1398f81879e94bb1702107981c8a3ed08754c8a83a7ee088e47"
      hash3 = "290161d5869781e1109033aa0932dbfcc7500e9b27f8140cce150040faa63a85"
      hash4 = "338de191c1976086e1b2df7a176f9810c0e3fe782f8bfcc0c146c9c3e601cc17"
      hash5 = "02382ceaa48910b77cd6566afb517a8511acaa4201e277007e2158e41e5bd9ed"
   strings:
      $s1 = "xubuzohesi nikeyobif jutenakafolizoteguboryizebita" fullword wide
      $s2 = "sozoxozopako" fullword ascii
      $s3 = "cudazirav" fullword ascii
      $s4 = "rugoxazewojehararebac" fullword wide
      $s5 = "fataravozudasikeluxuki" fullword wide
      $s6 = "pavacizoromawijajadizumoricot luduxosepoxikicewapo wowifa sadel kosihocufobatofo" fullword ascii
      $s7 = "bidifukelosirawacibic ditufusodeku rezapohanatohohazanokucojew" fullword ascii
      $s8 = "podakodejiv bayda" fullword wide
      $s9 = "kizanugukofuhidepupati vezoruzijesohufomapigefez wacuricahufomiz rolaziyakonov" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 2000KB and 6 of them
}

rule Malware_Obfuscator_Aug_3 {
   meta:
      description = "Malware.Obfuscator"
      author = "LightDefender"
      date = "2021-08-04"
      hash1 = "0f0681e9e6d6b67bbf1991810e504eb535c4acade6e018770371eca3b6ae24fd"
      hash2 = "214701ab0a4b8589212eb4fcd2870f8b795ce9be588a138d7219c1e2c49a588b"
      hash3 = "22c10989047a4816f8f8620cdf8527840d8dd3ebe5d403f02b05a162e55c058c"
      hash4 = "26b0361b9a69da29bc9494935959f981751bc509c80db36210c8ae42fab7cbb2"
      hash5 = "28b5df8bc8cea41221950c255ad421c2b3de3098077e18ee3a6a37af3b1e4c33"
      hash6 = "7d488eb1040f11cfdf31e5cc017f253bc9050bae1cfd474492018c314504c9bd"
      hash7 = "90ace75b5040a02eaf0c7999a687e995d1a11a591a34867374af33c50cb77daa"
      hash8 = "9735f688e3338582266589c582a22bdac2a0accbc423225ffb5d792801d0d1a5"
      hash9 = "a4bad40f6d7c48e8e824534d17504b1797cc9e9293ac02ce0dfbc3f24de3e836"
      hash10 = "ab4554366f37456ac0115a7df3b4114711fb8310ccc5754bfa10c474a0453210"
      hash11 = "be8b6e6da114bdcb1a060a06ace28d03550173a4a719b4704510e65ee6e47f02"
      hash12 = "d00f87049fb2c7cbbf506ca2361e8295fe06926f17e1d2c16cfe3e88a2902f5a"
      hash13 = "d61aa30773692c8573e9f1fa776ba99eeb89800bde45663582ee2d3bec5ceb70"
      hash14 = "d63046caaf9f654391a4e8b40acf3b743e7e6d96dfd1bec8e1b84f9f406c1ff1"
      hash15 = "dc9fcb210bb6436bee5b9cac39a3a5f9dd06a2e5ebf4062cf0b0e66d14d5236f"
      hash16 = "e02437cf00eea2bf3bf19fe48a9b19b3cc31360e22f101a0c24d5653b5b75467"
      hash17 = "fe19953fa73480f26d90f259d58c971eea3ad61cac7b15782c6648cc106cab29"
   strings:
      $s1 = "Xuhey sezezag husegux hihorujo fetoxupaxanizi. Tokopipifuk gibojobupubiga xibimenuwuc. Tumize yet. Hiyazipi mibuwiv bibetepepate" ascii
      $s2 = "kogzmuafoke.exu" fullword wide
      $s3 = "m tavibayic. Wuh. Yaya zalozaxudapibon gegeta. Joxelezasivujit huhekolotecic. Pekisaxodikozu penusukigas witexewenebonow. Yizore" ascii
      $s4 = "hohehalifacomuzigakemazonotacidi wimumofobuponetesu yakafif codizokubuguwe" fullword ascii
      $s5 = " bafolezecubeb riyujuboxosipi. Tutufevaw gakuyulecoy neguwog bopi pexijekov. Nefoba. Hotas jeyerab hib. Rilusinitabeyum nunitiru" ascii
      $s6 = "Hojufih wuz coyur codo gene*Yoz jeyimaboxax tokaluk mosovu madeterorux[Fif ginariti xekizuko hefuk sowaruhi fiduzanoco yihe johu" wide
      $s7 = "zukucesufofebuherozinigel" fullword ascii
      $s8 = "vaxohuhigicixaxofopuy" fullword ascii
      $s9 = "nagodusoxacohusunasuranogub" fullword ascii
      $s10 = "wegocefusoboyok" fullword ascii
      $s11 = "gavesuhemapusidil" fullword wide
      $s12 = "hilufihojibos" fullword wide
      $s13 = "guyubekavaluwayohafosomenegonum" fullword wide
      $s14 = "hitijepisixiduzetuj" fullword wide
      $s15 = "Joc7Deguvugekelem wovi sipotaraze runaguted vejulaserefiyam" fullword wide
      $s16 = "YASUTAXACOJIFIWIGIJUPEGU" fullword wide
      $s17 = "lada. Sekaxecagijod xavosoyopugak gexa xavoxudaz sotit. Nowefosayeyetiv mirijiwinesayi. Rokubetigone xegipib gure. Huzudoyupi na" ascii
      $s18 = "4Xucalomelucobog kiholicodepu soxegov nuvefafonon jutJRisukosubirakow fipud huday bumos sokabatobanite mujeka vudafocital guvevi" wide
      $s19 = "xojemuvogukudizacamoyo" fullword ascii
      $s20 = "ocohalubavo yot. Fufev takawuxuc kidicofuvepij veruboyigi xogisazekabo. Jexayutuze likitaxibare dewalaw yokekuneyihul. Xozenib j" ascii
   condition:
      uint16(0) == 0x5a4d and 8 of them
}

rule Malware_Obfuscator_Aug_5 {
   meta:
      author = "LightDefender"
      date = "2021-08-07"
      hash1 = "109a5ffb53cd3311e68c5a28f84fd1d7eb668de3db43a35c344f83785187f915"
      hash2 = "11ec5629d8faba1d833f479be2741e05dbf9cf4e391a651afef4ed3b4f9b8cc8"
      hash3 = "195929923f5068d260150448a6014f34906033d64dc6d463015a1cb430bca604"
      hash4 = "1f9b5c120efbd32491158582492dc17322b805c955626fbe43f2136a77b1812a"
      hash5 = "2ef729f2dea49ea7657c932812b60491b78316dec488ea605bd911cf4f0f80d5"
      hash6 = "36b9146fd7d45954b83a4da982270bc9274240acf44a683ef71e7387f784053a"
      hash7 = "3ba4fbce96a30b462422510cc8c3b772cf5f171e6968bb704e2465e66b3e8ddb"
      hash8 = "40ef0ea8d499ef74760da82a71c8cf548149e01826b62767c75431cc4cdad67f"
      hash9 = "4c25557b1d7a360b69a1ff457e63b31351e438dde35661a85550c403fd8f0d1a"
      hash10 = "6137b2968c98b110deef11d69b037a5d541b39b930628d12881b6daa5bdb9bb4"
      hash11 = "75d45ca23421acaac6b55133f964dc2b15cd8af4697cf58e63c2cba141821044"
      hash12 = "7b05bcd35f34368fcb1f2afd7350b8a6f003cbfaa9833f1a9e8d10a7997d49af"
      hash13 = "82a617b8169608e73ce761f98793ee01e8d6c936bd2f0a7048f1fcb9bea283c8"
      hash14 = "8ec4075cc5bce80c2feadf961db8ccc634518273cf55399bd4669c4bd5c96231"
      hash15 = "9228b7e3b6bebf36bd59a1d3245eb162316e12220422e721931f70e77cd687b3"
      hash16 = "a840a76e0a932c4b771b77bfeeee8804cecf0285ea37e6e757e955ab72586462"
      hash17 = "bd0c6248385512dedcb4b5fc5012463cd11ae4e6e2ef2de612621b868fbb9687"
      hash18 = "c9fae10d5d7d2177caff01384688e386f651232e5ff24c1729b4db443f857fd9"
      hash19 = "e07fbf3b9adba7e4aceb5cc6804c0002ee01c000d4e67ff3227f59eb9949c80e"
      hash20 = "e0fba3d44ffa244d8e910ce971fe3d384b4cfa3aa40b7f27d6021cda4815ec63"
      hash21 = "f5f438857e1d75cd3a0c7c8d8fde494ec31705db16f19e3d026d9f09e503fbf5"
      hash22 = "f700227db2f3823db45b8fa8f2341966c5d2de035f41b04b64714d6caaba92a2"
   strings:
      $s1 = "get_cmbYear" fullword ascii
      $s2 = "get_Scorpio" fullword ascii
      $s3 = "get_frmSagittarius" fullword ascii
      $s4 = "get_frmGemini" fullword ascii
      $s5 = "get_btnBack" fullword ascii
      $s6 = "get_frmPisces" fullword ascii
      $s7 = "get_frmTaurus" fullword ascii
      $s8 = "get_lblYear" fullword ascii
      $s9 = "get_frmMain" fullword ascii
      $s10 = "get_cmbMonth" fullword ascii
      $s11 = "get_frmAquarius" fullword ascii
      $s12 = "get_btnHoroscope" fullword ascii
      $s13 = "get_btnCheck" fullword ascii
      $s14 = "get_Aquarius" fullword ascii
      $s15 = "get_lblMonth" fullword ascii
      $s16 = "get_frmVirgo" fullword ascii
      $s17 = "get_frmAries" fullword ascii
      $s18 = "get_frmScorpio" fullword ascii
      $s19 = "get_lblZodiac" fullword ascii
      $s20 = "get_Sagitarius" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and 10 of them
      ) or ( all of them )
}
