rule Malware_Obfuscator_1 {
   meta:
      description = "Malware.Obfuscator"
      author = "LightDefender"
      date = "2021-07-01"
      hash1 = "9f2d892a4f124d1b693d8ceafc6ebe8741484109f68d82ec49ac2c9d781483a7"
      hash2 = "164d8d2e1460f1398f81879e94bb1702107981c8a3ed08754c8a83a7ee088e47"
      hash3 = "290161d5869781e1109033aa0932dbfcc7500e9b27f8140cce150040faa63a85"
      hash4 = "338de191c1976086e1b2df7a176f9810c0e3fe782f8bfcc0c146c9c3e601cc17"
      hash5 = "02382ceaa48910b77cd6566afb517a8511acaa4201e277007e2158e41e5bd9ed"
   strings:
      $s1 = "xubuzohesi nikeyobif jutenakafolizoteguboryizebita" fullword wide
      $s2 = "sozoxozopako" fullword ascii
      $s3 = "cudazirav" fullword ascii
      $s4 = "rugoxazewojehararebac" fullword wide
      $s5 = "fataravozudasikeluxuki" fullword wide
      $s6 = "pavacizoromawijajadizumoricot luduxosepoxikicewapo wowifa sadel kosihocufobatofo" fullword ascii
      $s7 = "bidifukelosirawacibic ditufusodeku rezapohanatohohazanokucojew" fullword ascii
      $s8 = "podakodejiv bayda" fullword wide
      $s9 = "kizanugukofuhidepupati vezoruzijesohufomapigefez wacuricahufomiz rolaziyakonov" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 2000KB and 6 of them
}

rule Malware_Obfuscator_Aug_3 {
   meta:
      description = "Malware.Obfuscator"
      author = "LightDefender"
      date = "2021-08-04"
      hash1 = "0f0681e9e6d6b67bbf1991810e504eb535c4acade6e018770371eca3b6ae24fd"
      hash2 = "214701ab0a4b8589212eb4fcd2870f8b795ce9be588a138d7219c1e2c49a588b"
      hash3 = "22c10989047a4816f8f8620cdf8527840d8dd3ebe5d403f02b05a162e55c058c"
      hash4 = "26b0361b9a69da29bc9494935959f981751bc509c80db36210c8ae42fab7cbb2"
      hash5 = "28b5df8bc8cea41221950c255ad421c2b3de3098077e18ee3a6a37af3b1e4c33"
      hash6 = "7d488eb1040f11cfdf31e5cc017f253bc9050bae1cfd474492018c314504c9bd"
      hash7 = "90ace75b5040a02eaf0c7999a687e995d1a11a591a34867374af33c50cb77daa"
      hash8 = "9735f688e3338582266589c582a22bdac2a0accbc423225ffb5d792801d0d1a5"
      hash9 = "a4bad40f6d7c48e8e824534d17504b1797cc9e9293ac02ce0dfbc3f24de3e836"
      hash10 = "ab4554366f37456ac0115a7df3b4114711fb8310ccc5754bfa10c474a0453210"
      hash11 = "be8b6e6da114bdcb1a060a06ace28d03550173a4a719b4704510e65ee6e47f02"
      hash12 = "d00f87049fb2c7cbbf506ca2361e8295fe06926f17e1d2c16cfe3e88a2902f5a"
      hash13 = "d61aa30773692c8573e9f1fa776ba99eeb89800bde45663582ee2d3bec5ceb70"
      hash14 = "d63046caaf9f654391a4e8b40acf3b743e7e6d96dfd1bec8e1b84f9f406c1ff1"
      hash15 = "dc9fcb210bb6436bee5b9cac39a3a5f9dd06a2e5ebf4062cf0b0e66d14d5236f"
      hash16 = "e02437cf00eea2bf3bf19fe48a9b19b3cc31360e22f101a0c24d5653b5b75467"
      hash17 = "fe19953fa73480f26d90f259d58c971eea3ad61cac7b15782c6648cc106cab29"
   strings:
      $s1 = "Xuhey sezezag husegux hihorujo fetoxupaxanizi. Tokopipifuk gibojobupubiga xibimenuwuc. Tumize yet. Hiyazipi mibuwiv bibetepepate" ascii
      $s2 = "kogzmuafoke.exu" fullword wide
      $s3 = "m tavibayic. Wuh. Yaya zalozaxudapibon gegeta. Joxelezasivujit huhekolotecic. Pekisaxodikozu penusukigas witexewenebonow. Yizore" ascii
      $s4 = "hohehalifacomuzigakemazonotacidi wimumofobuponetesu yakafif codizokubuguwe" fullword ascii
      $s5 = " bafolezecubeb riyujuboxosipi. Tutufevaw gakuyulecoy neguwog bopi pexijekov. Nefoba. Hotas jeyerab hib. Rilusinitabeyum nunitiru" ascii
      $s6 = "Hojufih wuz coyur codo gene*Yoz jeyimaboxax tokaluk mosovu madeterorux[Fif ginariti xekizuko hefuk sowaruhi fiduzanoco yihe johu" wide
      $s7 = "zukucesufofebuherozinigel" fullword ascii
      $s8 = "vaxohuhigicixaxofopuy" fullword ascii
      $s9 = "nagodusoxacohusunasuranogub" fullword ascii
      $s10 = "wegocefusoboyok" fullword ascii
      $s11 = "gavesuhemapusidil" fullword wide
      $s12 = "hilufihojibos" fullword wide
      $s13 = "guyubekavaluwayohafosomenegonum" fullword wide
      $s14 = "hitijepisixiduzetuj" fullword wide
      $s15 = "Joc7Deguvugekelem wovi sipotaraze runaguted vejulaserefiyam" fullword wide
      $s16 = "YASUTAXACOJIFIWIGIJUPEGU" fullword wide
      $s17 = "lada. Sekaxecagijod xavosoyopugak gexa xavoxudaz sotit. Nowefosayeyetiv mirijiwinesayi. Rokubetigone xegipib gure. Huzudoyupi na" ascii
      $s18 = "4Xucalomelucobog kiholicodepu soxegov nuvefafonon jutJRisukosubirakow fipud huday bumos sokabatobanite mujeka vudafocital guvevi" wide
      $s19 = "xojemuvogukudizacamoyo" fullword ascii
      $s20 = "ocohalubavo yot. Fufev takawuxuc kidicofuvepij veruboyigi xogisazekabo. Jexayutuze likitaxibare dewalaw yokekuneyihul. Xozenib j" ascii
   condition:
      uint16(0) == 0x5a4d and 8 of them
}
