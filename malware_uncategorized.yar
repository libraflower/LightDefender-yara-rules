rule malware_opendir_june_25 {
   meta:
      description = "opendir"
      author = "LightDefender"
      date = "2021-06-25"
      hash1 = "1ac909cef8e454178e18a5c5fa84760d4fb0233651a6365db15581387733aabc"
      hash2 = "c42172b4cef51a701d613ec6b932b6196ce557f4568360a3cb6a1a365161852b"
      hash3 = "50a65c497c8306ba179deb6e97669ed6e7b18b994f9008bc1f878c4617407898"
      hash4 = "55fbde2524b2528af0d6ff6e0bb1b017b2fb70451a29e952d7c1874b5deb9d9f"
      hash5 = "c8316290f86ab619e67d1196b39b88fa21e2534830357f455cc4ed7e9cec4e20"
      hash6 = "c0a3383b2bbc00b00bd99bb23833f573d0ee1c6ec78ae9548716a801bf01cace"
      hash7 = "71a7111ff8364335886e49e473cd070b7127cf3cd3fcabd9f9ec405c5a600572"
      hash8 = "2beba1a84ca6a357ff2e8fb49b014523c855b73195e04829db7ee94afe87ecd8"
      hash9 = "f942da2bd36afd4696e8ec09663fea116fa144bb331d244f6189a700a7e82229"
      hash10 = "7fd56bc08ad3ebae244a899150462d6eb0ffaad711e378b4eb2710e51807efd3"
      hash11 = "f24f2c5b077d2ab2160c2fb38c83949e7dd95a565eb095666f5d375a7acbdd91"
   strings:
      $s1 = "asdasddsa.exe" fullword wide
      $s2 = "        <requestedExecutionLevel level=\"asInvoker\" uiAccess=\"false\"/>" fullword ascii
      $s3 = "  <assemblyIdentity version=\"1.0.0.0\" name=\"MyApplication.app\"/>" fullword ascii
      $s4 = "GetLenToPosState" fullword ascii
      $s5 = "asdfasdasf" fullword wide
      $s6 = "gsdfsfsd" fullword wide
      $s7 = "asdasddsa" fullword ascii
      $s8 = "Decoder2" fullword ascii
      $s9 = "  <trustInfo xmlns=\"urn:schemas-microsoft-com:asm.v2\">" fullword ascii
      $s10 = "BitTreeDecoder" fullword ascii
      $s11 = "1.0.1.02" fullword wide
      $s12 = "LzmaDecoder" fullword ascii
      $s13 = "LiteralDecoder" fullword ascii
      $s14 = "LenDecoder" fullword ascii
      $s15 = "BitDecoder" fullword ascii
      $s16 = "1.0.1.2" fullword wide
      $s17 = "      <requestedPrivileges xmlns=\"urn:schemas-microsoft-com:asm.v3\">" fullword ascii
      $s18 = "fdsfds" fullword wide
      $s19 = "Resolve" fullword ascii
      $s20 = "MemoryStream" fullword ascii
      $s21 = "Encoding" fullword ascii
      $s22 = "Module" fullword ascii
      $s23 = "UpdateChar" fullword ascii
      $s24 = "OutWindow" fullword ascii
      $s25 = "UpdateMatch" fullword ascii
      $s26 = "SetLiteralProperties" fullword ascii
      $s27 = "UpdateShortRep" fullword ascii
      $s28 = "_windowSize" fullword ascii
      $s29 = "SetPosBitsProperties" fullword ascii
      $s30 = "IsCharState" fullword ascii
      $s31 = "m_Choice2" fullword ascii
      $s32 = "UpdateRep" fullword ascii
      $s33 = "  </trustInfo>" fullword ascii
      $s34 = "_streamPos" fullword ascii
      $s35 = "System.Runtime.CompilerServices" fullword ascii
      $s36 = "System.Reflection" fullword ascii
      $s37 = "System" fullword ascii
      $s38 = "_solid" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 500KB and ( 10 of them )
      ) or ( all of them )
}
